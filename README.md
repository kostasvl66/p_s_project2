# Παράλληλα Συστήματα Εργασία 2: OpenMP

### Άσκηση 2.1
---

### Άσκηση 2.2
---

### Παραδοχές:

- Όλες οι ακέραιες τιμές σε πίνακες και διανύσματα βρίσκονται στο διάστημα [0, 100], ώστε να είναι ευανάγνωστα τα δεδομένα.
- Το πρόγραμμα δεν μπορεί να λάβει τιμή διάστασης του πίνακα μεγαλύτερη απο 10^4, καθώς καταλήγει σε overflow ακεραίων.

### Υλοποιήσεις

#### main: Κύριο πρόγραμμα προς εκτέλεση:
- Ξεκινάει θέτοντας τα αναγκαία δεδομένα για την εκτέλεση του προγράμματος. Αυτά αποτελούν τα ορίσματα από την γραμμή εντολών(Διάσταση πίνακα, ποσοστό μηδενικών στοιχείων πίνακα, επαναλήψεις πολλαπλασιασμού πίνακα και αριθμό νημάτων προς εκτέλεση), καθώς και τα παράγωγα τους(συνολικό αριθμό τιμών που θα περιέχει ο πίνακας, αριθμό μηδενικών στοιχείων στον πίνακα). Επιπλέον, υπολογίζει τον αριθμό μη-μηδενικών στοιχείων που θα υπάρχουν στον πίνακα, για την δημιουργία και χρήση της Compressed Sparse Row αναπαράστασης αραιού πίνακα.
- Δημιουργεί εναν δυσδιάστατο πίνακα χρησιμοποιόντας δυναμική δέσμευση μνήμης (με αριθμό γραμμών "dimension" και αριθμό στηλών "dimension", καθώς είναι τετραγωνικός) και θέτει όλα τα στοιχεία του σε τυχαίους ακέραιους αριθμούς. Αφότου γεμίσει τον πίνακα με ακέραιους, μηδενίζει τόσους από αυτούς όσους έχει ορίσει ο χρήστης, σε τυχαίες θέσεις του πίνακα. Έτσι παράγεται ένας αραιός πίνακας.
- Δημιουργεί ένα διάνυσμα χρησιμοποιόντας δυναμική δέσμευση μνήμης(με αριθμό γραμμών "dimension"), και θέτει όλα τα στοιχεία του σε τυχαίους ακέραιους αριθμούς. 
- Πολλαπλασιάζει σειριακά τον πίνακα με το διάνυσμα τόσες φορές όσες έχει ορίσει ο χρήστης(με κάθε επανάληψη να λαμβάνει ώς διάνυσμα εισόδου το διάνυσμανυσμα εξόδου της προιγούμενης), και μετράει τον χρόνο εκτέλεσης όλων των επαναλήψεων.
- Παράγει σειριακά την CSR αναπαράσταση του πίνακα(μέσω της σειριακής συνάρτησης CSR_create) και μετράει τον χρόνο εκτέλεσής.
- Πολλαπλασιάζει σειριακά την CSR αναπαράσταση του πίνακα με το διάνυσμα τόσες φορές όσες έχει ορίσει ο χρήστης(με κάθε επανάληψη να λαμβάνει ώς διάνυσμα εισόδου το διάνυσμανυσμα εξόδου της προιγούμενης), και μετράει τον χρόνο εκτέλεσης όλων των επαναλήψεων.
- Παράγει παράλληλα την CSR αναπαράσταση του πίνακα(μέσω της παράλληλης συνάρτησης CSR_create_omp) και μετράει τον χρόνο εκτέλεσής.
- Πολλαπλασιάζει παράλληλα τον πίνακα με το διάνυσμα τόσες φορές όσες έχει ορίσει ο χρήστης και μετράει τον χρόνο εκτέλεσης.
- Πολλαπλασιάζει παράλληλα την CSR αναπαράσταση του πίνακα με το διάνυσμα τόσες φορές όσες έχει ορίσει ο χρήστης και μετράει τον χρόνο εκτέλεσης.
- Τέλος, συλλέγει όλα τα δεδομένα σημαντικά προς τον χρήστη(τις παραμέτρους του προγράμματος και τους χρόνους εκτέλεσης της κάθε διαδικασίας) σε αντίστοιχες λίστες, και τα αποθηκεύει σε ένα εξωτερικό αρχείο με όνομα "test_data.txt".

#### matrixlib: Βιβλιοθήκη συναρτήσεων που σχετίζονται με πίνακες και λίστες:

- Δομή **CSR_t**: Χρησιμοποιέιται για την αποθήκευση της πυκνής(CSR) μορφής ενός πίνακα. Αποτελείται από μία λίστα ακεραίων για τις μή-μηδενικές τιμές του αρχικού πίνακα(**val_array**),  μία λίστα ακεραίων για τις στήλες όπου βρίσκονται αυτές οι τιμές(**col_array**), και μία λίστα "δεικτών" στις θέσεις της "**col_array**" όπου βρίσκονται τα πρώτα μή-μηδενικά στοιχεία κάθε γραμμής του αρχικού (αραιού) πίνακα("**start_idx**").

- **CSR_create**: Δημιουργεί την CSR αναπαράσταση ενός δυσδιάστατου πίνακα ακεραίων. Λαμβάνει ένα δυσδιάστατο πίνακα ακεραίων, τους αριθμούς στηλών και γραμμών του πίνακα, καθώς και τον αριθμό μή μηδενικών στοιχείων. Αρχικοποιεί τις λίστες μίας δομής CSR_t, και  προσθέτει τον αριθμό των μή-μηδενικών στοιχείων στην τελευταία θέση της λίστας "**start_idx**". Διατρέχει σειριακά κάθε γραμμή του αρχικού πίνακα, όπου αναθέτει τιμή στο αντίστοιχο στοιχείο της λίστας "**start_idx**" και διατρέχει κάθε στήλη του αρχικού πίνακα ώστε να προσθέσει τις μή-μηδενικές τιμές του στην λίστα "**val_array**" και τις αντίστοιχες στήλες τους στην "**col_array**". Τέλος, επιστρέφει την συμπληρωμένη δομή CSR_t.
- **mat_vec**: Πολλαπλασιάζει έναν δυσδιάστατο πίνακα ακεραίων με ένα διάνυσμα. Λαμβάνει τον αρχικό πίνακα ακεραίων, το διάνυσμα με το οποίο αυτός θα πολλαπλασιαστεί, και τους αριθμούς γραμμών και στηλών του πίνακα. Αρχικοποιεί το διάνυσμα αποτελέσματος. Διατρέχει σειριακά κάθε γραμμή και στήλη του πίνακα και αθροίζει τα γινόμενα των στοιχείων κάθε γραμμής με τα στοιχεία κάθε στήλης του διανύσματος. Τέλος, επιστρέφει το συμπληρωμένο διάνυσμα αποτελέσματος.
- **CSR_mat_vec**: Εφαρμόζει τον πολλαπλασιασμό δυσδιάστατου πίνακα ακεραίων με διάνυσμα, χρησιμοποιόντας την CSR(πυκνή) αναπαράσταση του πίνακα. Λαμβάνει την δομή CSR_t που περιέχει την CSR αναπαράσταση, το διάνυσμα με το οποίο θα πολλαπλασιαστεί και την διάσταση που αντιστοιχεί στον πίνακα και το διάνυσμα. Αρχικοποιεί το διάνυσμα αποτελέσματος. Διατρέχει σειριακά τις στήλες του διανύσματος, βρίσκει το πρώτο μή-μηδενικό στοιχείο κάθε γραμμής του αρχικού πίνακα, καθώς και της ακριβώς επόμενης γραμμής. Διατρέχει όλα τα μή-μηδενικά στοιχεία ανάμεσα σε αυτά που έχει βρεί και αθροίζει τα γινόμενα τους με τα στοιχεία κάθε στήλης του διανύσματος. Τέλος, επιστρέφει το συμπληρωμένο διάνυσμα αποτελέσματος.
- **print_matrix**: Εκτυπώνει έναν δυσδιάστατο πίνακα ακεραίων στην κονσόλα. Λαμβάνει τον δυσδιάστατο πίνακα και τους αριθμούς γραμμών στυλών του.
- **print_CSR**: Εκτυπώνει μία αναπαράσταση CSR στην κονσόλα. Λαμβάνει την δομή CSR_t και τον αριθμό γραμμών του αρχικού πίνακα.
- **mat_vec_omp**: Εκτελεί την ίδια λειτουργία με την "**mat_vec**", αλλά ο βρόγχος που διατρέχει τις γραμμές και στήλες του αρχικού πίνακα(και τις στήλες του διανύσματος) έχει παραλληλοποιηθεί μέσω εντολής "**pragma omp parallel for**", με αριθμό νημάτων ορισμένο στο "**main.c**" από παράμετρο γραμμής εντολών. Οι μεταβλητές "**i**" και "**j**" του βρόγχου έχουν τεθεί ως ιδιωτικές για κάθε νήμα, καθώς αποτελούν εξάρτηση για την πρόσβαση στον πίνακα και τα διανύσματα στις πράξεις.
- "**CSR_mat_vec_omp**": Εκτελεί την ίδια λειτουργία με την "**CSR_mat_vec**", αλλά ο βρόγχος που διατρέχει τις στήλες του διανύσματος έχει παραλληλοποιηθεί μέσω εντολής "**pragma omp parallel for**". Οι μεταβλητές "**i**", "**j**", "**row_start**" και "**row_end**" του βρόγχου έχουν τεθεί ως ιδιωτικές για κάθε νήμα, καθώς αποτελούν εξάρτηση για την πρόσβαση στον πίνακα και τα διανύσματα στις πράξεις.
- "**compare_array**": Συγκρίνει όλα τα στοιχεία δύο λιστών ανά θέση και επιστρέφει τον αριθμό στοιχείων που δεν ταιριάζουν.

### Άσκηση 2.3
---
